 {% extends 'Market/base.html' %}
 {% load static %}

 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

 {% block title %}–ë–æ–Ω—É—Å–Ω–∏–π –º–∞–≥–∞–∑–∏–Ω - –†–µ—Å—Ç–æ—Ä–∞–Ω "–°–º–∞–∫–æ—Ç–∞"{% endblock %}

 {% block content %}
 <section class="container mt-4">
     <!-- –ü—Ä–æ—Å—Ç–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑ –±–∞–ª–∞–Ω—Å–æ–º -->
     <div class="text-center mb-4">
         <h1 class="fw-bold">üéÅ –ë–æ–Ω—É—Å–Ω–∏–π –º–∞–≥–∞–∑–∏–Ω</h1>
         <p class="text-muted">–í–∞—à—ñ –±–∞–ª–∏: <span class="fw-bold text-warning">{{ user_bonus_points|floatformat:0 }}</span></p>
     </div>

     <!-- –ü–µ—Ä–µ–º–∏–∫–∞—á –º—ñ–∂ –∑–≤–∏—á–∞–π–Ω–∏–º —Ç–∞ –±–æ–Ω—É—Å–Ω–∏–º –º–∞–≥–∞–∑–∏–Ω–æ–º -->
     <div class="text-center mb-3">
         <div class="btn-group" role="group">
             <a href="{% url 'Market:menu' %}" class="btn btn-outline-primary">
                 üõí –ó–≤–∏—á–∞–π–Ω–∏–π –º–∞–≥–∞–∑–∏–Ω
             </a>
             <a href="{% url 'Market:bonus_products' %}" class="btn btn-warning active">
                 üéÅ –ë–æ–Ω—É—Å–Ω–∏–π –º–∞–≥–∞–∑–∏–Ω ({{ user_bonus_points|floatformat:0 }} –±–∞–ª—ñ–≤)
             </a>
         </div>
     </div>

     <!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ—è –ø–æ —Å–µ–∫—Ü—ñ—è—Ö -->
     <nav class="nav sticky-top justify-content-center py-2 bg-white shadow-sm" style="z-index: 100;">
         {% for section in sections %}
             <a href="#{{ section }}" class="btn btn-outline-primary mx-1 text-capitalize">{{ section }}</a>
         {% endfor %}
     </nav>

     <!-- –¢–æ–≤–∞—Ä–∏ –ø–æ —Å–µ–∫—Ü—ñ—è—Ö -->
     {% for section in sections %}
         <h2 id="{{ section }}" class="mt-5 text-capitalize text-center fw-bold">{{ section }}</h2>
         <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
             {% for product in products %}
                 {% if product.section == section %}
                     <div class="col">
                         <div class="card h-100 shadow-sm border-0 product-card" onclick="location.href='{% url 'Market:product_detail' product.id %}'" style="cursor: pointer;">
                             {% if product.image %}
                                 <div class="card-img-top-container">
                                     <img src="{{ product.image.url }}" class="card-img-top product-image" alt="{{ product.name }}">
                                 </div>
                             {% endif %}
                             <div class="card-body d-flex flex-column">
                                 <h5 class="card-title fw-bold text-truncate">{{ product.name }}</h5>
                                 <p class="card-text text-muted mb-auto">{{ product.description|truncatechars:100 }}</p>
                                 <div class="mt-3">
                                     <div class="d-flex justify-content-between align-items-center mb-2">
                                         <h4 class="text-warning mb-0">{{ product.price|floatformat:0 }} –±–∞–ª—ñ–≤</h4>
                                         <small class="text-muted">‚Ç¥{{ product.price }}</small>
                                     </div>

                                     <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–∫—É–ø–∫–∏ –∑–∞ –±–∞–ª–∏ -->
                                     {% if user_bonus_points >= product.price %}
                                         <form method="post" action="{% url 'Market:buy_with_bonus' product.id %}" onClick="event.stopPropagation();">
                                             {% csrf_token %}
                                             <button type="submit" class="btn btn-warning w-100">
                                                 ‚ö° –ö—É–ø–∏—Ç–∏ –∑–∞ –±–∞–ª–∏
                                             </button>
                                         </form>
                                     {% else %}
                                         <button class="btn btn-outline-secondary w-100" disabled>
                                             –ü–æ—Ç—Ä—ñ–±–Ω–æ {{ product.price|floatformat:0 }} –±–∞–ª—ñ–≤
                                         </button>
                                     {% endif %}
                                 </div>
                             </div>
                         </div>
                     </div>
                 {% endif %}
             {% endfor %}
         </div>
     {% endfor %}

     <div class="text-center mt-5 mb-5">
         <p class="text-muted">–ó–∞ –∫–æ–∂–Ω—É –ø–æ–∫—É–ø–∫—É –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ 10% –±–∞–ª—ñ–≤ –≤—ñ–¥ —Å—É–º–∏</p>
         <a href="{% url 'Market:menu' %}" class="btn btn-success">–ó–≤–∏—á–∞–π–Ω–∏–π –º–∞–≥–∞–∑–∏–Ω</a>
     </div>
 </section>

 <style>
     .product-card {
         transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
     }
     .product-card:hover {
         transform: translateY(-5px);
         box-shadow: 0 10px 20px rgba(0,0,0,0.1);
     }
     .card-img-top-container {
         height: 200px;
         overflow: hidden;
         background-color: #f8f9fa;
         display: flex;
         align-items: center;
         justify-content: center;
     }
     .product-image {
         max-width: 100%;
         max-height: 100%;
         object-fit: contain;
     }
     .card-title {
         font-size: 1.25rem;
     }
 </style>
 {% endblock %}